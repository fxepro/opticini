# Compliance Data Tables and Authoritative Sources Matrix

**Purpose:** Clear mapping of all database tables that need data loading and their authoritative data sources.

**Date:** 2026-01-06

---

## Matrix

| App | Table/Model | Database Table Name | Data to Load | Authoritative Data Source(s) |
|-----|-------------|---------------------|--------------|------------------------------|
| **compliance_frameworks** | `ComplianceFramework` | `compliance_frameworks` | Framework records (SOC 2, PCI-DSS, ISO 27001, etc.) | **OpenControl** (GitHub: opencontrol/schemas, opencontrol/compliance-masonry)<br>**Vendor Docs** (AWS, Azure, GCP SOC 2 mappings)<br>**PCI SSC** (Public Quick Guide)<br>**ISO Annex A** (Public structure) |
| **compliance_controls** | `ComplianceControl` | `compliance_controls` | Control records (CC6.1, 1.1.1, A.9.2.3, etc.) | **OpenControl** (Control IDs, names, descriptions for SOC 2)<br>**complytime-pci-dss** (GitHub: complytime/complytime-pci-dss)<br>**attack-control-framework-mappings** (GitHub: center-for-threat-informed-defense/attack-control-framework-mappings)<br>**OWASP ASVS** (GitHub: OWASP/ASVS) |
| **compliance_controls** | `ComplianceControlFrameworkMapping` | `compliance_control_framework_mappings` | Control-to-Framework mappings | **Same as ComplianceControl** (derived from control data) |
| **compliance_controls** | `ControlEvidenceRequirement` | `compliance_control_evidence_requirements` | Evidence requirements per control | **YOUR IP** (Must create - not in any source)<br>**Reference:** Industry best practices, auditor expectations |
| **compliance_evidence** | `ComplianceEvidence` | `compliance_evidence` | Evidence records (scans, logs, documents) | **Generated by tools** (SSLyze, OWASP ZAP, etc.)<br>**Manual uploads** (User-provided)<br>**System logs** (Internal systems) |
| **compliance_evidence** | `ComplianceEvidenceControlMapping` | `compliance_evidence_control_mappings` | Evidence-to-Control mappings | **Generated automatically** when evidence is linked to controls (user action or automation) |
| **compliance_policies** | `CompliancePolicy` | `compliance_policies` | Policy documents | **Generated by Opticini** (auto-generated from controls/evidence)<br>**Manual creation** (User-provided)<br>**Templates** (Template-based generation) |
| **compliance_policies** | `CompliancePolicyFrameworkMapping` | `compliance_policy_framework_mappings` | Policy-to-Framework mappings | **Generated automatically** when policy is linked to framework |
| **compliance_audits** | `ComplianceAudit` | `compliance_audits` | Audit session records | **User-created** (No external source - created by users for audit sessions) |
| **compliance_audits** | `ComplianceAuditFrameworkMapping` | `compliance_audit_framework_mappings` | Audit-to-Framework mappings | **Generated automatically** when audit is created |
| **compliance_reports** | `ComplianceReport` | `compliance_reports` | Report records | **Generated by Opticini** (No external source - generated from frameworks/controls/evidence) |
| **compliance_reports** | `ComplianceReportFrameworkMapping` | `compliance_report_framework_mappings` | Report-to-Framework mappings | **Generated automatically** when report is created |
| **compliance_reports** | `ComplianceReportShare` | `compliance_report_shares` | Report sharing links | **Generated by Opticini** (No external source) |
| **compliance_tools** | `ComplianceTool` | `compliance_tools` | Tool configuration records | **Already seeded** (Management command: setup_compliance_tools.py)<br>**Source:** Opticini Compliance – Open-Source Tooling Matrix |

---

## Detailed Breakdown by App

### 1. compliance_frameworks

**Table:** `compliance_frameworks`  
**Model:** `ComplianceFramework`

**Data to Load:**
- Framework name (e.g., "SOC 2 Type I", "PCI-DSS v4.0")
- Framework code (e.g., "SOC2-T1", "PCI-DSS-4")
- Category (security, privacy, industry, regional)
- Description
- Icon name
- Status (not_started, in_progress, ready, at_risk)

**Authoritative Sources:**
- **OpenControl** (GitHub: opencontrol/schemas, opencontrol/compliance-masonry) - SOC 2 structure
- **Vendor Mapping Docs** (AWS, Azure, GCP) - SOC 2 summaries
- **PCI SSC Quick Guide** (Public) - PCI-DSS framework info
- **ISO Annex A** (Public structure) - ISO 27001 framework info

**What's Available:**
- ✅ Framework structure/names
- ✅ Framework categories
- ❌ Framework descriptions (must create summaries)

---

### 2. compliance_controls

**Table:** `compliance_controls`  
**Model:** `ComplianceControl`

**Data to Load:**
- Control ID (e.g., "CC6.1", "1.1.1", "A.9.2.3")
- Control name/title
- Control description (summarized - legal)
- Category/domain (e.g., "CC6", "1", "A.9")
- Control type (preventive, detective, corrective)
- Severity (critical, high, medium, low)
- Evaluation method (automated, manual, hybrid)
- Frequency (continuous, daily, weekly, monthly, annually)

**Authoritative Sources:**
- **OpenControl** (GitHub: opencontrol/compliance-masonry) - SOC 2 controls (CC1-CC9)
  - Control IDs: CC1.1, CC6.1, etc.
  - Control names: "Logical Access Controls", etc.
  - Control descriptions: Summarized (legal to use)
- **complytime-pci-dss** (GitHub: complytime/complytime-pci-dss) - PCI-DSS controls
  - Control IDs: 1.1.1, 1.1.2, etc.
  - Control titles and summaries
- **attack-control-framework-mappings** (GitHub) - ISO 27001 controls
  - Control IDs: A.5.1, A.9.2.3, etc.
  - Control titles and objectives
- **OWASP ASVS** (GitHub: OWASP/ASVS) - Additional ISO mappings

**What's Available:**
- ✅ Control IDs
- ✅ Control names/titles
- ✅ Control descriptions (summarized)
- ❌ Control metadata (severity, type, evaluation method) - Must assign
- ❌ Control relationships - Must analyze

---

**Table:** `compliance_control_framework_mappings`  
**Model:** `ComplianceControlFrameworkMapping`

**Data to Load:**
- Control ID → Framework ID mappings
- Framework name (denormalized)

**Authoritative Sources:**
- **Derived from ComplianceControl data** - Controls are mapped to frameworks based on which framework they belong to

**What's Available:**
- ✅ Can be derived from control data (if controls specify framework)
- ❌ Must create mappings if not specified in source

---

**Table:** `compliance_control_evidence_requirements`  
**Model:** `ControlEvidenceRequirement`

**Data to Load:**
- Control ID
- Evidence type (tls_scan, dast, security_scan, config_scan, system_log, manual_upload, policy_document, attestation)
- Source app (SSLyze, OWASP ZAP, Manual, etc.)
- Freshness days (30, 90, 365, etc.)
- Required (true/false)
- Description

**Authoritative Sources:**
- **YOUR IP** - Not available from any external source
- **Reference:** Industry best practices, auditor expectations
- **Typical:** 2-4 evidence requirements per control

**What's Available:**
- ❌ Nothing - Must create all evidence requirements yourself
- ✅ This is your intellectual property (not copyrighted)

---

### 3. compliance_evidence

**Table:** `compliance_evidence`  
**Model:** `ComplianceEvidence`

**Data to Load:**
- Evidence records (scans, logs, documents)
- Source (automated, manual)
- Source type (tls_scan, dast, security_scan, config_scan, manual_upload, system_log)
- Source name (SSLyze, OWASP ZAP, Manual, etc.)
- File/content
- Status, validity period, expiration

**Authoritative Sources:**
- **Generated by tools** (SSLyze, OWASP ZAP, Trivy, etc.) - Automated evidence
- **Manual uploads** - User-provided documents
- **System logs** - Internal system logs

**What's Available:**
- ✅ Generated by tools when integrated
- ✅ User uploads
- ❌ No pre-existing evidence data to load

---

**Table:** `compliance_evidence_control_mappings`  
**Model:** `ComplianceEvidenceControlMapping`

**Data to Load:**
- Evidence ID → Control ID mappings
- Framework ID and names (denormalized)

**Authoritative Sources:**
- **Generated automatically** when evidence is linked to controls
- **User action** - Users link evidence to controls
- **Automation** - System links evidence based on evidence requirements

**What's Available:**
- ❌ No pre-existing mappings - Created dynamically

---

### 4. compliance_policies

**Table:** `compliance_policies`  
**Model:** `CompliancePolicy`

**Data to Load:**
- Policy documents
- Policy content
- Policy type (security, data_retention, incident_response, ai_governance, vendor_risk, custom)
- Status, version, ownership

**Authoritative Sources:**
- **Generated by Opticini** - Auto-generated from controls/evidence
- **Manual creation** - User-provided policies
- **Templates** - Template-based generation

**What's Available:**
- ❌ No external source - Policies are generated or created by users

---

**Table:** `compliance_policy_framework_mappings`  
**Model:** `CompliancePolicyFrameworkMapping`

**Data to Load:**
- Policy ID → Framework ID mappings

**Authoritative Sources:**
- **Generated automatically** when policy is linked to framework

**What's Available:**
- ❌ No pre-existing mappings - Created dynamically

---

### 5. compliance_audits

**Table:** `compliance_audits`  
**Model:** `ComplianceAudit`

**Data to Load:**
- Audit session records
- Audit type, status, timeline
- Evidence locked, findings, scores

**Authoritative Sources:**
- **User-created** - No external source
- **Created by users** for audit sessions

**What's Available:**
- ❌ No external source - Created by users

---

**Table:** `compliance_audit_framework_mappings`  
**Model:** `ComplianceAuditFrameworkMapping`

**Data to Load:**
- Audit ID → Framework ID mappings

**Authoritative Sources:**
- **Generated automatically** when audit is created

**What's Available:**
- ❌ No pre-existing mappings - Created dynamically

---

### 6. compliance_reports

**Table:** `compliance_reports`  
**Model:** `ComplianceReport`

**Data to Load:**
- Report records
- Report type, status, content
- Generated files

**Authoritative Sources:**
- **Generated by Opticini** - No external source
- **Generated from** frameworks/controls/evidence data

**What's Available:**
- ❌ No external source - Generated by system

---

**Table:** `compliance_report_framework_mappings`  
**Model:** `ComplianceReportFrameworkMapping`

**Data to Load:**
- Report ID → Framework ID mappings

**Authoritative Sources:**
- **Generated automatically** when report is created

---

**Table:** `compliance_report_shares`  
**Model:** `ComplianceReportShare`

**Data to Load:**
- Report sharing links
- Expiration, passwords, access counts

**Authoritative Sources:**
- **Generated by Opticini** - No external source

---

### 7. compliance_tools

**Table:** `compliance_tools`  
**Model:** `ComplianceTool`

**Data to Load:**
- Tool configuration records
- Tool name, type, category, status
- API keys, endpoints, configuration

**Authoritative Sources:**
- **Already seeded** - Management command exists: `setup_compliance_tools.py`
- **Source:** Opticini Compliance – Open-Source Tooling Matrix

**What's Available:**
- ✅ Already populated via management command
- ✅ No additional data loading needed

---

## Summary: What Needs Data Loading

### ✅ Needs External Data Loading

1. **compliance_frameworks.ComplianceFramework**
   - Source: OpenControl, PCI SSC, ISO Annex A
   - Data: Framework records (SOC 2, PCI-DSS, ISO 27001)

2. **compliance_controls.ComplianceControl**
   - Source: OpenControl, complytime-pci-dss, attack-control-framework-mappings, OWASP ASVS
   - Data: Control records (~67 SOC 2, ~180 PCI-DSS, ~114 ISO 27001)

3. **compliance_controls.ComplianceControlFrameworkMapping**
   - Source: Derived from ComplianceControl data
   - Data: Control-to-Framework mappings

4. **compliance_controls.ControlEvidenceRequirement**
   - Source: YOUR IP (must create)
   - Data: Evidence requirements per control (~134-268 for 67 controls)

### ❌ Does NOT Need External Data Loading

1. **compliance_evidence.ComplianceEvidence** - Generated by tools/users
2. **compliance_evidence.ComplianceEvidenceControlMapping** - Created dynamically
3. **compliance_policies.CompliancePolicy** - Generated/created by users
4. **compliance_audits.ComplianceAudit** - Created by users
5. **compliance_reports.ComplianceReport** - Generated by system
6. **compliance_reports.ComplianceReportFrameworkMapping** - Generated automatically
7. **compliance_reports.ComplianceReportShare** - Generated by system
8. **compliance_tools.ComplianceTool** - Already seeded

---

## Priority Order for Data Loading

### Phase 1: Frameworks (High Priority)
1. Load `ComplianceFramework` records
   - SOC 2 Type I, SOC 2 Type II
   - PCI-DSS v4.0
   - ISO/IEC 27001:2022

### Phase 2: Controls (High Priority)
2. Load `ComplianceControl` records
   - SOC 2 controls (~67)
   - PCI-DSS controls (~180)
   - ISO 27001 controls (~114)

3. Create `ComplianceControlFrameworkMapping` records
   - Map controls to frameworks

### Phase 3: Evidence Requirements (Medium Priority)
4. Create `ControlEvidenceRequirement` records
   - Define evidence requirements per control
   - YOUR IP - Must create

### Phase 4: Dynamic Data (No Loading Needed)
5. Evidence, Policies, Audits, Reports - Generated/created dynamically

---

**Last Updated:** 2026-01-06  
**Status:** Complete Matrix

